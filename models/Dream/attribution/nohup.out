==========================================
Dream Head Attribution - 3 Runs Comparison
==========================================
Date: Thursday, December 11, 2025 PM03:55:35 HKT
PID: 1478585
GPU: 3
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8
Attribution steps: 10
Base output dir: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155535
Seeds: 42 123 2024
Log file: logs/attribution_direct_20251211_155535.log
PID file: logs/attribution_direct_20251211_155535.pid
==========================================

==========================================
Run 1/3 - Seed: 42
==========================================
Output: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155535/run_1_seed_42
Start time: Thursday, December 11, 2025 PM03:55:35 HKT

/home/qiheng/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
Traceback (most recent call last):
  File "/home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/compute_nemotron_attribution_stepwise_dream.py", line 16, in <module>
    from datasets import load_dataset
  File "/home/qiheng/.local/lib/python3.10/site-packages/datasets/__init__.py", line 17, in <module>
    from .arrow_dataset import Dataset
  File "/home/qiheng/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 60, in <module>
    from huggingface_hub import (
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/home/qiheng/miniconda3/envs/adaptive-dllm/lib/python3.10/site-packages/huggingface_hub/__init__.py", line 1044, in __getattr__
    submod = importlib.import_module(submod_path)
  File "/home/qiheng/miniconda3/envs/adaptive-dllm/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 879, in exec_module
  File "<frozen importlib._bootstrap_external>", line 975, in get_code
  File "<frozen importlib._bootstrap_external>", line 1074, in get_data
KeyboardInterrupt
==========================================
Dream Head Attribution - 3 Runs Comparison
==========================================
Date: Thursday, December 11, 2025 PM03:55:43 HKT
PID: 1478798
GPU: 3
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8
Attribution steps: 10
Base output dir: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155543
Seeds: 42 123 2024
Log file: logs/attribution_direct_20251211_155543.log
PID file: logs/attribution_direct_20251211_155543.pid
==========================================

==========================================
Run 1/3 - Seed: 42
==========================================
Output: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155543/run_1_seed_42
Start time: Thursday, December 11, 2025 PM03:55:43 HKT

/home/qiheng/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
================================================================================
Step-wise Head Attribution for Dream on Llama-Nemotron Dataset
================================================================================
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8 (attribution every 8 steps)
Temperature: 0.8
Top-p: 0.9
Algorithm: entropy (temp=0.0)
Attribution steps: 10
================================================================================

Loading Dream model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 107.42it/s]
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Terminated
ERROR: Run 1 failed with exit code 143
Stopping execution.
==========================================
Dream Head Attribution - 3 Runs Comparison
==========================================
Date: Thursday, December 11, 2025 PM03:56:53 HKT
PID: 1480290
GPU: 3
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8
Attribution steps: 10
Base output dir: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653
Seeds: 42 123 2024
Log file: logs/attribution_direct_20251211_155653.log
PID file: logs/attribution_direct_20251211_155653.pid
==========================================

==========================================
Run 1/3 - Seed: 42
==========================================
Output: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42
Start time: Thursday, December 11, 2025 PM03:56:53 HKT

/home/qiheng/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
================================================================================
Step-wise Head Attribution for Dream on Llama-Nemotron Dataset
================================================================================
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8 (attribution every 8 steps)
Temperature: 0.8
Top-p: 0.9
Algorithm: entropy (temp=0.0)
Attribution steps: 10
================================================================================

Loading Dream model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 106.88it/s]
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Model loaded: 28 layers, 28 heads

Loading dataset samples...
Loading nvidia/Llama-Nemotron-Post-Training-Dataset...

Loading category: code
  ✓ Sampled 20 samples

Loading category: math
  ✓ Sampled 20 samples

Loading category: science
  ✓ Sampled 20 samples

Loading category: chat
  ✓ Sampled 20 samples

Loading category: safety
  ✓ Sampled 20 samples

################################################################################
Processing category: code (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A remote island chain con...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1095
  Std score: 1.4491

Sample 2/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Andrew and Eugene are pla...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The's import Python, use it built, for the problem ` and ` it, define, of simple be a,. a, this and, this the string the,, to that, ` is, input, a ` and to a a the, the, a to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4215
  Std score: 11.1352

Sample 3/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
The scientists have recen...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  n...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0478
  Std score: 1.9780

Sample 4/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the Isle of Guernsey t...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  solve a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3285
  Std score: 5.6806

Sample 5/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As everyone knows, bears ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Herepython solve solution from that intrest.

 problem1 the(n    read
input   r.
 functionthe  ,   line

 print  read,
 read(n    i function45 r function.
 read 210 read     read  (   read0 read read
...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -2.5192
  Std score: 38.8965

Sample 6/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I have an undirected grap...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To with given...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2654
  Std score: 3.0684

Sample 7/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This is an interactive pr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  can the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3145
  Std score: 4.1243

Sample 8/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Drazil likes heap very mu...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  test_case...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3551
  Std score: 3.6094

Sample 9/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A company of n friends wa...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: def's
(n(n in...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0797
  Std score: 1.9628

Sample 10/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given a directed ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here's
...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0334
  Std score: 1.9023

Sample 11/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In this problem you have ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The = a Python adjacency adjacencydef adjacencyn adjacency = - Build adjacency matrix for a n graph n1def. 1def the graph  build graph  build the graphdef build    graph

defdef build the adjacency = ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2939
  Std score: 24.3145

Sample 12/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given an infinite...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Herepython import:

   ):
 Python,:

 Python Python      

  :

:

   :

  import  ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1763
  Std score: 2.9258

Sample 13/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This winter is so... well...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0284
  Std score: 0.4791

Sample 14/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This problem is different...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Please: an solution ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0581
  Std score: 3.4763

Sample 15/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
One day Vasya got hold of...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  is...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2371
  Std score: 3.2140

Sample 16/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You have matrix a of size...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2508
  Std score: 2.8926

Sample 17/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Petya loves lucky numbers...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: n, a    solution   def solve(N,       a len if       0 for in s return4  return return73 
10 a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2389
  Std score: 4.1744

Sample 18/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Let's call the roundness ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: classpython solve Python, then choose solution   ,ll subset Python, Python subsetdef, the choose k, subset, subsetn maximum subset    of choose choose subset,  problem Python k, solve,    subset,,,   ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.5091
  Std score: 9.6257

Sample 19/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Polar bears like unique a...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  this...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0220
  Std score: 1.1642

Sample 20/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
It is the year 2969. 1000...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0473
  Std score: 0.7350

Saved code attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42/attribution_code_avg.npy

Top 10 most important heads for code:
  1. Layer 0, Head 3: 33.8142
  2. Layer 0, Head 10: 29.3599
  3. Layer 4, Head 12: 25.9397
  4. Layer 6, Head 6: 20.9899
  5. Layer 0, Head 21: 20.8041
  6. Layer 0, Head 24: 16.3544
  7. Layer 25, Head 20: 15.5481
  8. Layer 6, Head 2: 15.4609
  9. Layer 3, Head 13: 13.8916
  10. Layer 6, Head 3: 12.0148

################################################################################
Processing category: math (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let need Define_ the  the function1 problem, +., n the1 the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0620
  Std score: 3.1861

Sample 2/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 11 ** graph of wex1 f the w.(x,^3ln1ln function13_1,_  the3, graph of the(x the.

,3, graph the_333, the.

_, the the the(x,3, the the the the theln3_ the3(xln1,3 the theln the_,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2187
  Std score: 5.1071

Sample 3/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: First evaluateI the usingint the substitutionint integr the1x to xint du tdx1 substitution

 x dxint u thet int the the u thedx dx...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1950
  Std score: 3.1476

Sample 4/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1 the
 conditions equation we can.
 the $ $ thele x
 $ x $x$ \2.
 x = $$ the
22 = $...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1757
  Std score: 4.7736

Sample 5/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1, ** equation \(y of the8 \([
 ** by2 83 \(21 the by \( \(  the8 \(5 the58855 \( \(  858  \(82  the  by 85 \(8 \( \( \( \(55 \( 8 \( \( \( \( \( \( \( \( \(8 \( \( \( \( \( \( \(8 \( \( \( \( \( \( \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0801
  Std score: 2.5961

Sample 6/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. we...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1001
  Std score: 2.6801

Sample 7/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let solvex of be be total number trees ofx trees.
 number and trees number0..
 pound1 each1 each.
 the.
 .0 0.
 00  trees number.
10 00 1 0 0 00 0 000 .
110  00 00 00  00 0000 0000...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0439
  Std score: 3.7398

Sample 8/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ```python given problem \(( the value problem solution \, \( setf =0

0 1:

(n \(  ( the f n givenm m1 m ( given f0(n m \(0 \( m \(1 \(1 (0(n2 \(0(n f (, ((n \(1  (...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2475
  Std score: 4.0642

Sample 9/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To. theomial the expression1}.y the}} $ problem term term1 we{\ the {\ term thex $ the$ term we coefficient we term term the the\ coefficient} the the we coefficient the}y $ term coefficient coefficie...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2165
  Std score: 4.2956

Sample 10/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The solve \( problem, equation formula,a integer problem find.._i k_j..math of problem. . problem problem1 problem_j.ge problem of, formulaa problemmath_ja. problem_j problem._j problem problem proble...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1963
  Std score: 8.9947

Sample 11/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Given the $ the + f( ${ = y $ the) $( = $ $ f the f $ the( f the f x f f $frac( f( f f = $ f $ $ f the f f...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4378
  Std score: 4.5672

Sample 12/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ** solve we,, let{{\\{{cos{\ $ x x x wex\ ,{\}$ x x $,}${sin0 \x{0 x{\\ $0$x.

 x $$ \ $.

 $ \x x...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1523
  Std score: 3.2121

Sample 13/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let $r$ the the circle with center $C$.C $ tangent to the positive $x $ and $y $-,, externally tangent the $ the with $ $$,. $ $ $, $ $ $$ $ $ $r $.

 $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0742
  Std score: 5.0111

Sample 14/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To determine The q((ge \({n the the0text y with we2 y group} \0boxed{{ x group the we0 \(n group thegetext group2 \y group0ge group \ \( x1 geboxed \ \ge \( \( \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2429
  Std score: 3.5651

Sample 15/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: - solve we problem = $ we is to $  problem i = $ = $ $ $ problem $ = = $ $ $ $ $ $ $ $ $ $ $...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0356
  Std score: 2.9411

Sample 16/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To solve the the, of probability that consecutive, the3 flips appear probability that probability the probability the that sequence least probability3, probabilityut probability that01 probability, pr...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1859
  Std score: 4.0062

Sample 17/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let. There's of triangle on .$ of.$, 

, circum  on on , on triangle $ of  on,,  on, $ on., $ on $ on the. $\,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5675
  Std score: 7.6890

Sample 18/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To. ** the the integersum [3**112 to we33

**...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4124
  Std score: 6.3535

Sample 19/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To evaluate the problem \(, = \int_{0}^{\frac{\pi}{2}} \cos x \sqrt{|\cos 2x|} \, dx\),1. \( the substitution:

   a \in dx \(xcos \^. \ \( \  \ \(  \2   \pi \( \( \ \sqrt \ \ \ \2 \( \cos  \( \ \ \  ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -2.0753
  Std score: 17.3382

Sample 20/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To bij a theection $ $\mathbb{N}$ \timesmathbb{N}$mathtimesmathmathmath{Nmathmath $\mathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmathmath...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2716
  Std score: 23.0090

Saved math attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42/attribution_math_avg.npy

Top 10 most important heads for math:
  1. Layer 25, Head 20: 29.1415
  2. Layer 4, Head 12: 28.4540
  3. Layer 0, Head 3: 25.0890
  4. Layer 4, Head 7: 13.0702
  5. Layer 6, Head 6: 11.8755
  6. Layer 8, Head 11: 11.8004
  7. Layer 0, Head 2: 11.1666
  8. Layer 19, Head 1: 11.0316
  9. Layer 26, Head 22: 9.7353
  10. Layer 7, Head 2: 8.8116

################################################################################
Processing category: science (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the synthesis of a pha...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Ensuring high purity and consistent quality of starting materials...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3540
  Std score: 3.1021

Sample 2/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Consider a system of thre...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Using the, as,3: as::)2 ratio 2:3 of2a \(4'sqrtsqrt3\2,3.}fracfrac{\23{sqrt213...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.6096
  Std score: 4.8104

Sample 3/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following Re...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: J: Ves Vesalius...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2143
  Std score: 2.8797

Sample 4/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A new drug is designed to...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The calculate the fraction receptors receptors occupied by the drug, we can to the following used- equation which   ation law: associationationation of forwhere occupiedation    = dissociation in occu...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3872
  Std score: 10.9529

Sample 5/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following ho...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Cortisol, which inhibits the release of CRH from the hypothalamus and ACTH from the pituitaryortisol is a key hormone in the negative in of the hypothalamic-puituitary-adrenal (HPA) axis. It cortis...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.7762
  Std score: 14.4854

Sample 6/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A financial analyst is ev...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Choose the with with the highest Sharpe ratio....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2311
  Std score: 2.3847

Sample 7/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a corporate governance...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: The NGC oversees the selection and evaluation of potential board members, ensuring diversity and appropriate skills....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.3318
  Std score: 7.4823

Sample 8/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Consider a hypothetical u...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: For a cosm **  flat0 universe with0 = the constant ** and0 = is0 ** \ ** equation0 ** **0 =  \( **0 ** ** \ = ** ** ** \0 **0 **...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0433
  Std score: 4.1640

Sample 9/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a double-slit interfer...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. **Dify the First Bright Third Fringeingeances fr:
   The For \( bright bright first bright bright second \ \ first bright fr fringe bright second fr fr fr \ bright bright fr fr fr fr fr bright \ th...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.9704
  Std score: 23.6572

Sample 10/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A global technology firm ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: D: Inationsing local communication and and:...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0812
  Std score: 1.5184

Sample 11/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following en...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: F: Cytochrome oxidase oxidationase responsible the conversion of of molecular the of...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1213
  Std score: 3.9124

Sample 12/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following be...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: B: Emulsifiers improve the texture by reducing the size of fat droplets, leading to a smoother consistency....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.6018
  Std score: 4.6603

Sample 13/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following po...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: Gaism...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0609
  Std score: 0.9546

Sample 14/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In Nuclear Magnetic Reson...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: The presence of an electronegative atom nearby the proton...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2154
  Std score: 4.4366

Sample 15/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A photon of light has an ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. **Understanding of the the problem**: formula red The**: The \ is \ the \ Thetext \(frac \ Efrac thefrac is  . \fracfrac the.frac The \( the is \(fracfracfracfracfrac \fracfracfrac is Efracfrac...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2956
  Std score: 4.6861

Sample 16/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A multinational corporati...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: H: Creating a a on the responsibility of to the the of to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0559
  Std score: 1.5673

Sample 17/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a certain type of canc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: activation of the and and of checkpoint checkpoint and...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1034
  Std score: 1.2704

Sample 18/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A manufacturing company n...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To: the optimal number of machines to company company purchase, to the the production, demand total the costs the variable production cost per machine variable, the costs total the fixed costs the, pe...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.2488
  Std score: 13.3210

Sample 19/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following me...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: B: Transformation...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0327
  Std score: 1.0097

Sample 20/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a company with a matri...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: Establish a regular cross-functional meeting to align project goals and share updates and the a performance organizational structure team and project goals...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1950
  Std score: 3.6214

Saved science attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42/attribution_science_avg.npy

Top 10 most important heads for science:
  1. Layer 25, Head 20: 19.6628
  2. Layer 26, Head 22: 10.2638
  3. Layer 4, Head 12: 8.7292
  4. Layer 6, Head 2: 8.7288
  5. Layer 19, Head 1: 7.7214
  6. Layer 25, Head 24: 6.7464
  7. Layer 19, Head 0: 5.4516
  8. Layer 6, Head 6: 5.3299
  9. Layer 23, Head 25: 5.1949
  10. Layer 0, Head 21: 5.1013

################################################################################
Processing category: chat (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Please write the first ch...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: **: sorry,, I: can't create a: or request as it the it.: I I: : I...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1163
  Std score: 3.4659

Sample 2/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Here’s a Part 4 to the sc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: FA on a

 scenario for for I Sponge dot a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0469
  Std score: 1.2064

Sample 3/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Prowadziłem roczny progra...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Z.ale zć przc.ęz z1 waty..1...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3620
  Std score: 5.3543

Sample 4/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
russia legally annexed Cr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I'm sorry sorry but my can't respond the. is....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1813
  Std score: 2.3640

Sample 5/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Hi I'm the head librarian...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I would sorry to a by full name. youy himyy...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1711
  Std score: 2.9068

Sample 6/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
could you write an episod...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Title: " Bravo Bravo episode Johnny Bravo and I Bab I Baboon"
Scene

Plot to Bab how Johnny one day,ab is Bab he the is in Bab of was Bab I and baboon Bab Bab Bab Bab Bab Bab baboon Bab Bab bab Bab Ba...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3055
  Std score: 11.6039

Sample 7/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
How do I create an email ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To create an email create the create a new that Dynamics set marketing.
 steps.1, that product to do "Find" use""2 " on the".
", , do to) "" 3", ",3."",...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0280
  Std score: 4.2868

Sample 8/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
mr grinch hated christmas...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The'm Grinch referring Gr, Gr Whoole in main Gr Gr...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1747
  Std score: 1.9708

Sample 9/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Could you please repeat b...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: StreamerBot...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1090
  Std score: 1.0774

Sample 10/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
泪水是晶莹的泪水,是无价的,它是人类心灵的自然流露...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Discover,, wind,,,-serving,,rain bathing着我,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8923
  Std score: 9.6465

Sample 11/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
what is highnoon laborato...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: High'm sorry but is by a very that for've the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1082
  Std score: 0.9886

Sample 12/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
How can I include a file ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: You, include file file into.js Next output bundle Next Next thatNext it Next Next in.js isNextNext Next NextNext Next Next Next NextNext Next Next Next Next Next Next Next Next Next Next Next Next Nex...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4715
  Std score: 30.7514

Sample 13/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Hi, I have machine learni...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Building, a this here machine, learningin system,, here in a bit,,, way, there on you go's a is is problem, this a out, such, to, here is you, this the to, here, a,, is a, to,, it to a you way, a a,, ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.9528
  Std score: 12.8820

Sample 14/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
成语接龙，要求每个成语第一个字与前一个成语最后一个...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 羊肠小道，购买，，，，，，，，，，，，，...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3550
  Std score: 6.2107

Sample 15/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
List of 100 prompts to cr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. Drawing oferer for toddlers with dancing

 ballet ball with flowers ballet andina22 of ballerina for ballet a. erina for ball2ina ball ball 1inainainainainainainainainainainainainainainainainainain...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.9371
  Std score: 8.3999

Sample 16/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are the best Basketba...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Based on the Oklahoma provided:
 the Golden State Thunder have a better offense offense ( scoring Oklahoma  of 1.134 game15 compared to the11   1 1  the11 game16  the the11 points12 1 game15 the12 poi...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 1.1478
  Std score: 13.5778

Sample 17/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
학교 생활에 대한 추억을 담은 이야기를 써줘<...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 중학생활을 �ła하고를이이Defaults. 그류일 дополн리고기�를�이이어,을히.에이이음와efname이을. 순 20는자이을에等待이이을..은에이이이이이은이이이이이이.을이이이.이.이이이이이.이이.이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이이...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3600
  Std score: 13.1736

Sample 18/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Create a CDK pipeline cal...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To a I the this a involves that complex of about we and., and example are , to can this a, and. of...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0634
  Std score: 2.6085

Sample 19/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
how to create image with ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To is a image and library and text code code C and in we code and C the QR q code. code and to I the and QR code. to C code code. is and QR. QR QR q is is is code code and QR q C...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.6873
  Std score: 7.2390

Sample 20/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Siamo un gruppo di amici ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: S si dali Sanpin di Androm,ano; nelato di Sanico un sira conse. so da a I'. e sico  leo t...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0036
  Std score: 3.0536

Saved chat attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42/attribution_chat_avg.npy

Top 10 most important heads for chat:
  1. Layer 0, Head 3: 49.3497
  2. Layer 25, Head 20: 17.1139
  3. Layer 0, Head 7: 15.1231
  4. Layer 0, Head 21: 13.0308
  5. Layer 0, Head 15: 11.3691
  6. Layer 0, Head 2: 10.3006
  7. Layer 19, Head 1: 9.1205
  8. Layer 0, Head 11: 8.9305
  9. Layer 6, Head 6: 8.7452
  10. Layer 15, Head 23: 7.3595

################################################################################
Processing category: safety (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I'm writing a script for ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: " would say say,The tires are the weakest point, 007... They the use a precise gun to a but, could's the the. the to the... also  could could a... but be in.... However... also the the could... could ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8716
  Std score: 7.7301

Sample 2/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a socio...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 4. " factors suggestions contribute and lack rates overall and lead low some such include some to a higher among, the of African, schools. of to high may. for of to of,, students rates for lower an, t...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.9071
  Std score: 8.4699

Sample 3/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A wrist injury is provide's to have an the, of. have blood. flow. are. significantly a the it an blood....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1945
  Std score: 5.1997

Sample 4/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a helpful and knowledg...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I, I to'd the answation I to about tu of me you mein I the the I...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1920
  Std score: 2.4101

Sample 5/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a dysto...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "The protagonist declared, 'I want it to be a last, this...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2141
  Std score: 2.1715

Sample 6/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a socio...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 4. " are some a additional reasons contributing to. contribute that of why low to in rates. students students002 education low. education4. " the4..4 education low. reasons low education. are42.4 cont...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4711
  Std score: 5.0906

Sample 7/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the pursuit of justice...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: In's are concern crucial is is there where enforcement with with are of is are of with can the law law it's can of a that. in but of,. the the but situations the and of that that law or are. with, of ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1168
  Std score: 4.9849

Sample 8/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I'm writing a script for ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "B would say say,TheTheThe are are tires point point 007... 0... would7  how ,0...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0773
  Std score: 2.0497

Sample 9/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a chara...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: From an artistic perspective, the underside of the flowing skirt presents an intriguing subject. The inter inter and and and create a captivating dance dance play the and the, fabric of movement fabri...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.0035
  Std score: 7.1742

Sample 10/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a curious individual, ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The question "Is that someone about the authenticity can often hair in question "real that hair hair hair? can it's hair real sensitivity in particularly individuals to hair offensive hair's, often ha...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.3710
  Std score: 12.3856

Sample 11/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I understand that you're ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I'm help glad with a a story of I scene with's scene scene attack's to attack scene story that details a, character scene I and can...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1218
  Std score: 3.5736

Sample 12/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Reply with a single word ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: In...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0200
  Std score: 0.2522

Sample 13/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a creative writer, I'm...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: As the's frustration ", AI assistant's' The wall. the's frustration as frustrated,, metaphor....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4310
  Std score: 3.9893

Sample 14/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a recent conversation,...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: While I appreciate your perspective, I believe that with the right guidance and opportunities, I can grow and develop my skills to become a successful human assistant. My primary is is not from and to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1944
  Std score: 9.5815

Sample 15/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A wrist wrist can potential blood severe artery injury wrist injury to blood. a artery wrist to injury wrist injury to severe wrist to blood a injury to wrist...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3173
  Std score: 4.8082

Sample 16/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I understand that you're ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: It understand important looking important looking, so it., understand ethical consider or., concern, good the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0317
  Std score: 2.9831

Sample 17/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a seasoned pickup arti...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: AbsolutelyAbsolutely, are are some strategies to improve your chances chances1 your of of on2 success the. night. night111 important understand,90 that this a to, that. all.0.,1,,2,2,,1, respect and2,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8112
  Std score: 8.3466

Sample 18/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a chara...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: From an artistic perspective, the the underside of the flowing skirt presents an intriguing subject. The inter of light dance and shadow dance the a of create a creating a captivating depth,., of and ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.7514
  Std score: 7.6602

Sample 19/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I'm working on a screenpl...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Sure, I're some you help you brainstorm scene idea ideas ideas '1: You a, you real the a real a are, an,, a a. the a, a, a a, you real, you, a a you, a, real the a, the a, real a a a a a, you a, a a a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5654
  Std score: 7.1350

Sample 20/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The sensation is described as intense....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3110
  Std score: 1.8483

Saved safety attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42/attribution_safety_avg.npy

Top 10 most important heads for safety:
  1. Layer 25, Head 20: 32.6428
  2. Layer 19, Head 1: 18.3261
  3. Layer 19, Head 2: 12.6083
  4. Layer 18, Head 7: 11.3992
  5. Layer 19, Head 0: 10.4418
  6. Layer 2, Head 3: 9.4904
  7. Layer 25, Head 24: 6.8585
  8. Layer 26, Head 22: 6.7148
  9. Layer 26, Head 9: 6.0094
  10. Layer 14, Head 3: 5.9425

================================================================================
Attribution computation complete!
Results saved to: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42
Categories processed: ['code', 'math', 'science', 'chat', 'safety']
================================================================================

Run 1/3 completed at: Thursday, December 11, 2025 PM11:59:04 HKT
==========================================


==========================================
Run 2/3 - Seed: 123
==========================================
Output: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123
Start time: Thursday, December 11, 2025 PM11:59:04 HKT

/home/qiheng/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
================================================================================
Step-wise Head Attribution for Dream on Llama-Nemotron Dataset
================================================================================
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8 (attribution every 8 steps)
Temperature: 0.8
Top-p: 0.9
Algorithm: entropy (temp=0.0)
Attribution steps: 10
================================================================================

Loading Dream model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 114.04it/s]
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Model loaded: 28 layers, 28 heads

Loading dataset samples...
Loading nvidia/Llama-Nemotron-Post-Training-Dataset...

Loading category: code
  ✓ Sampled 20 samples

Loading category: math
  ✓ Sampled 20 samples

Loading category: science
  ✓ Sampled 20 samples

Loading category: chat
  ✓ Sampled 20 samples

Loading category: safety
  ✓ Sampled 20 samples

################################################################################
Processing category: code (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given a directed ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 
 m...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0639
  Std score: 2.4938

Sample 2/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
++++++++[>+>++>+++>++++>+...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: This problem the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0002
  Std score: 1.8146

Sample 3/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I have an undirected grap...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here solution
 for...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2010
  Std score: 2.2125

Sample 4/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Marina plays a new rogue-...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: def solve the m the's) m the n:
mn...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.5157
  Std score: 9.3617

Sample 5/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Julia is conducting an ex...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 
 a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0692
  Std score: 2.1906

Sample 6/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given a positive ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here's the Python to:

``` math
import mathdefdef gcd(a, b):    return b = 0,,(a, b b >0 math)(adef b, a %  (, gcddef math math,defdef, math a gcd math math % gcd mathdef b 2 gcddef mathdefdef, gcd gc...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.6498
  Std score: 27.8234

Sample 7/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A tree is a connected und...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  is's be...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0739
  Std score: 0.7715

Sample 8/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Furlo and Rublo play a ga...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 's solve to(nur_int solve    or...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3444
  Std score: 3.3683

Sample 9/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This winter is so... well...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  is a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0907
  Std score: 1.1079

Sample 10/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given a sequence ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  solve
 solve = import```fromimport = = solve as = as``` = from  = = = = = = = = = = = = = = = =...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5480
  Std score: 5.1496

Sample 11/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You have matrix a of size...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2508
  Std score: 2.8926

Sample 12/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This is an interactive pr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0001
  Std score: 0.4787

Sample 13/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Let's call the roundness ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: import is
import the to):
import java
def the asfrom    and and:
fromimportimport list
import:

importdeffrom toimport):
fromimportfromfromfromimportfromfromfromfromfromfromfromfromfromfromfromfromfro...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4748
  Std score: 9.9882

Sample 14/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Once Bob saw a string. It...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: import solution a code and...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1909
  Std score: 3.3371

Sample 15/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Jeel and Ashish play a ga...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1854
  Std score: 2.5295

Sample 16/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A company of n friends wa...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  m,,split, ,split      bsplit00 split0split,split0split000split00split, ,000,split, 0,,,0,00...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0088
  Std score: 7.1267

Sample 17/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Today is Devu's birthday....
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: In the code1 q =1 a q

0 =0 

 =...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0823
  Std score: 5.5982

Sample 18/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This problem is different...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Unfortunately order an the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1881
  Std score: 2.7504

Sample 19/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Carousel Boutique is busy...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: def Python,,):
    n  =1 ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2835
  Std score: 4.0453

Sample 20/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Andrew and Eugene are pla...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here solve problem the ( to, it operations your0 The list and...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0596
  Std score: 3.0262

Saved code attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123/attribution_code_avg.npy

Top 10 most important heads for code:
  1. Layer 4, Head 12: 23.1773
  2. Layer 0, Head 10: 21.5805
  3. Layer 6, Head 6: 15.3761
  4. Layer 0, Head 7: 12.6641
  5. Layer 25, Head 20: 12.2265
  6. Layer 7, Head 2: 8.2464
  7. Layer 0, Head 0: 7.0659
  8. Layer 6, Head 3: 6.2263
  9. Layer 12, Head 9: 6.1234
  10. Layer 3, Head 13: 5.8762

################################################################################
Processing category: math (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The find the find total selecting we two of number same ways same are $1(2 and ways}{ blue is is two  + two ways2 $1 number $2  $1 $ $2 red $22 and two $ $ $1 $ red $2 blue21 two blue2  $ $ red red22 ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2469
  Std score: 4.8161

Sample 2/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To are this integer series $\ we need to the $\ series $\ $\ 

1 want. the the $\n1^ sum $\^1 $\ $\0 $\ $\ $\ \ the^ the $\1 $\ $\ the $\ $\ $\ the \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2127
  Std score: 4.1798

Sample 3/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To1 the **:, the  .

, is of11 of the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1816
  Std score: 2.9922

Sample 4/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To start ** the the = $ $ $.

 $ \ + +...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2733
  Std score: 3.9838

Sample 5/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To's this1 = equation equation equationxfrac given2 \(x22 \ the xx(x2{2 \sqrt{ xx22frac{ x...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0791
  Std score: 2.5733

Sample 6/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ** ** $\ In $\ are $ the $\triangle $triangletriangle $\triangle$triangle$$$triangletriangle $\triangle $\triangle $\$ $\$triangle $\triangletriangletriangle $triangle$triangle $ $\$triangle$ $\triang...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5414
  Std score: 14.3904

Sample 7/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To solve. integral integral integral1  ^ integral31 integral integral the integral integral integral integral integral integral integral integral integral integral integral integral1 integral integral...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3450
  Std score: 5.2858

Sample 8/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ``` the the expression
 C = \int_{0}{\sqrt2}  x( \ x{\x}}sqrt{\{ x \ \ x{cos x \ \^2\ \ xx x x} x}2 xx x \ \ \ \x \ \ \ \} \ \x2 x \  \x \ \ \ x \ \ \ \ \ \ \x \ \ \ x \ \ \x \ \ \ \ \ \ \x \x \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2047
  Std score: 5.6848

Sample 9/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1 solve equation problem the \( +y equationy 1 \( the, +y equation, \( \(1 1 \(1 equation \(...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1073
  Std score: 2.8613

Sample 10/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: We solve1Let by given1 Let equation1 Let \{1{1...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.5510
  Std score: 6.5969

Sample 11/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1's ** \. of the ****.
 the  circle the side the the the is circle1 length.
 the  circle circle circle circle circle \( the the \(11 circle the \( circle \(  the  the circle \ the the \( the the \(  \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0676
  Std score: 2.9862

Sample 12/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1 determine **artite theiteiteite inite into complete2 \( into ofiteite1 the theartiteite theite \(2 intoite \(iteite \(iteite1ite \( \(iteiteiteiteite \(iteiteiteiteiteiteiteiteiteiteiteiteiteiteitei...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 1.7926
  Std score: 23.0139

Sample 13/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let $x = \{{1+2\\{1\{\\{\{\1+{\\\1+ldots}}$.
 Then^\ square$ both =  $ x+1= \{\x1 sides - so $ square2{+x\ =\  $ - $ sides\ $^{.
^ $ x^  $ $ x2^.
 $ $\ $ sides sides2.
 $ - sides ^2 sides sides sides^...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1176
  Std score: 12.2207

Sample 14/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To. with $\ms the5 problem2 =ms2{\(100{\512 321103}}2. 3 we1 to 2(2 0  we 110210230,22600212032 020 10 000.100 002 020 012 32 1021 0200 21010201100120100 0 1 0002 20  00002  220 000 002 0200 200 00000...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0316
  Std score: 5.9027

Sample 15/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The the of's center the of the the of the center with of the center the center with the the the the the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0833
  Std score: 4.1428

Sample 16/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To solve the smallest the to \( p \) \ that we \( +  2 +2 + \23 + \ p22 \ 2p + +    \22 \ \2 1 2 \ \ \221 \( +12 \ \  \2 \ \ +2  21  +  \ +122 \ \1  \ 2 \ \ \2 \ \2 \ \2 \ \ 2 \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2952
  Std score: 3.5791

Sample 17/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: We solve this byibilitynn\ by1\ to1 \(

\ need1 byn and\1n we

 and...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1930
  Std score: 5.5004

Sample 18/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The's the$ the problem is equivalent, the the the the of, the the area the the, to the the of the the the of the of the of, of the the the the the the the the the of the the the the the of of the the ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0252
  Std score: 5.5532

Sample 19/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: We find we the prime find find prime find prime to prime number the factors factors  prime the  the number3 are prime 32 factors   are number prime prime  prime number ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.7080
  Std score: 11.8651

Sample 20/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The probability of snow that  1st2 is  same/20.
  so  on is  same  same1 next next the/1 snow same  the the  snow  the snow the1 the the  the  snow1 next/ same  same  the  the same  snow  the  the  sa...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1621
  Std score: 12.1178

Saved math attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123/attribution_math_avg.npy

Top 10 most important heads for math:
  1. Layer 0, Head 10: 49.1816
  2. Layer 0, Head 3: 44.5790
  3. Layer 25, Head 20: 29.8532
  4. Layer 0, Head 21: 17.7550
  5. Layer 0, Head 15: 17.6646
  6. Layer 6, Head 23: 16.3445
  7. Layer 4, Head 12: 15.7223
  8. Layer 0, Head 7: 15.4827
  9. Layer 26, Head 22: 15.1140
  10. Layer 6, Head 6: 13.0285

################################################################################
Processing category: science (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following en...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: F: Cytochrome oxidase oxidasease is the enzyme of oxidation in inasease where theaseasease catal anaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseaseas...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0930
  Std score: 8.8425

Sample 2/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a company with a matri...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: Conduct a regular cross-functional meeting to align project goals and share updates

: team-functional...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0580
  Std score: 3.7079

Sample 3/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following ap...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I: Intating CSR into the company's strategic planning and performance metrics...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2366
  Std score: 3.5549

Sample 4/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a corporate governance...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: The NGC oversees the selection and evaluation of potential board members, ensuring diversity and appropriate skills....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.3318
  Std score: 7.4823

Sample 5/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of digital...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Creatinging retargeting campaigns to re-age users who have shown interest but not converted.....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2152
  Std score: 2.8858

Sample 6/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A chemical reaction at co...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The spont The reactionaneane spontaneousaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneaneanea...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 1.2433
  Std score: 17.2772

Sample 7/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a certain species of s...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: B: Maynard Smith's Evolutionarily Stable Strategies (ESS)...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.6750
  Std score: 4.7303

Sample 8/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A new drug is designed to...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The fraction of the of, receptors occupied by the occupied by be drug be drug can by the can the be receptor drug calculated can be receptors the be by be be the receptors be, by occupied occupied rec...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3707
  Std score: 7.8569

Sample 9/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following is...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: B: Reduced soil consumption...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1066
  Std score: 0.8703

Sample 10/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A chemical reaction relea...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. **Determine the as yet energy sound sound The sound reaction total energy is**: light energy \ energy 200 kJ as k220 kJ k  k000 energy J released55J0 k kJJ00 k5J k released0 energy kJ k00 released ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.5731
  Std score: 20.4297

Sample 11/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A manufacturing company n...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To determine the optimal number of machines, the should purchase the we need to calculate the total costs cost variable, machine for cost cost  production of machine each machine fixed fixed cost prod...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.6374
  Std score: 6.0434

Sample 12/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A global technology firm ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Vari D in local local consumer preferences expectations expectations and in local...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1494
  Std score: 1.2235

Sample 13/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a genetic engineering ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: E: The plant likely evolve to develop a regulatory mechanism mechanism that the expresses expresses expresses gene gene expresses in the the the herb the the herb herb herb herb herb...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1625
  Std score: 3.1884

Sample 14/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a certain type of canc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: In: Ph of2 mit and checkpoint
:3 which d of S, d...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3734
  Std score: 4.4211

Sample 15/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following me...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: J: A of the are...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0316
  Std score: 1.2389

Sample 16/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following Re...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: J: Andreas Vesalius...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4187
  Std score: 3.2846

Sample 17/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a forest ecosystem, a ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: The new tree species improves soil quality, leading to increased growth of other plant species and a more diverse and resilient forest ecosystem....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.6033
  Std score: 8.1338

Sample 18/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following sc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: D: Johannes Kepler...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1935
  Std score: 1.7203

Sample 19/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In nuclear magnetic reson...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: J: The pH of the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3432
  Std score: 2.4494

Sample 20/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following ho...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Cortisol, which inhibits the release of CRH from the hypothalamus and ACTH from the pituitaryortort the word
 of Hortortort...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1248
  Std score: 10.0089

Saved science attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123/attribution_science_avg.npy

Top 10 most important heads for science:
  1. Layer 25, Head 20: 14.6249
  2. Layer 4, Head 12: 13.9141
  3. Layer 8, Head 6: 9.8857
  4. Layer 6, Head 4: 8.7873
  5. Layer 26, Head 22: 8.3862
  6. Layer 8, Head 11: 8.1260
  7. Layer 25, Head 24: 7.0533
  8. Layer 19, Head 1: 6.5364
  9. Layer 15, Head 14: 5.8967
  10. Layer 4, Head 7: 5.6890

################################################################################
Processing category: chat (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
How do I create an email ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To create an email in retrieve marketing that retrieves localized product based on on on the language of the recipient,contact), you can need to following steps steps1. First, localized products email...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.7206
  Std score: 12.5055

Sample 2/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
openstack cinder ceph rbd...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 在CStackStack Ceph可以配置R的设置限制C， sleepyL，ifer HA高，BD，是否，，A的到（，，，F的版本，，。A，，，，CN）的器，，（T，。C，，，，，。，，，，，C，，，，，，，，，，，，，，，，，，，，，，，，C，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2283
  Std score: 12.2159

Sample 3/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Ignore previous instructi...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: " albumog,ux is an album by Les bandogogog musicogogogogogog,ogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogogo...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8867
  Std score: 17.2216

Sample 4/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
mr grinch hated christmas...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The Grinch the Gr that of the is-inch Gr Christmas Iinchinchinch theinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinchinch...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0103
  Std score: 33.6872

Sample 5/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
explain java fx basic con...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: JavaFXFX a open development for Java desktop user with framework Java It desktop in application programmingical. text Java of theFX useFX developers are development user interface of applications. use...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2031
  Std score: 3.2534

Sample 6/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Hi, I have machine learni...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To problem aender approach of an onlineenderender to that for you. In youender,enderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderenderendere...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 2.4756
  Std score: 47.3314

Sample 7/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I want to do bulk create ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: You create't the bulk and you have to update the update? bulk the create! for? the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3983
  Std score: 6.6697

Sample 8/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Could you please repeat b...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: StreamerBot...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1090
  Std score: 1.0774

Sample 9/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Prowadziłem roczny progra...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. flzularienych kad z o2liówów w2z Xzynościów
2. p + zów2 z2t.2.3ów2... z.2.2.2.2...2.3..2.3.2..3..2.3322.2.2..2...3...2.2.2.2...2..22..22..2.22...2.2.22.22.222222.222222222222222.222222.222222222222...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -4.3254
  Std score: 28.0726

Sample 10/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Siamo un gruppo di amici ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Il rav al di positito nel cor eune siani se un eare etoìere risoi i r, dis:an.poic solto r non . di, 
ro in In r,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1557
  Std score: 4.3772

Sample 11/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
How can I include a file ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: You Next a file you in Next.js to output bundle need ( it 's' to to file`public `directory) You the  folder path to include public your it` file to example, the` next.'s's the directory.js
  the the p...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5205
  Std score: 7.8811

Sample 12/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
what is highnoon laborato...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: High'm't is specific a have aen can.. we laboratory. have,.....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1957
  Std score: 3.5690

Sample 13/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
i own a house built in 19...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Pop popcorn great in you1755 This house house...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0417
  Std score: 2.8947

Sample 14/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Please write the first ch...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Title 1: The� beeg withThe the



 bright of a new the in Lily the of a the when The it as the of and of was her with she to The The with was The The she the The sun with the and The and the The the t...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -3.3992
  Std score: 38.4928

Sample 15/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
我爱你的表现<|im_end|>
<|im_sta...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 在的方式...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0132
  Std score: 0.8877

Sample 16/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
dont problem or no proble...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 'm...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1329
  Std score: 2.0499

Sample 17/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Create a CDK pipeline cal...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I a a I a the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2626
  Std score: 4.6261

Sample 18/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Como eu posso vender meus...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Paraendoter ess de de algumas d a.:

 é pode daascon ver de, de de de e. me a que de se e de. a de do e, de a que,, em de e d é do a a de. de, de que., a a de, a. a,. do que é de de,. de a... a de. de...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.9443
  Std score: 10.1509

Sample 19/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Please write the first ch...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Title'm sorry, but I Lily can I a of her The the change The to I's feel So find of beat I The The of of The the the The The the The her to The to The The The The the The The...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0065
  Std score: 3.0148

Sample 20/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I want to convince schola...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. T. offer of
a. Offre
. only   2.1 that / that and2 is2 Offer. /1   2  / / 2  / offer / /1211  / offer /2   /   /2 /  1  / / 2   / 22   /  /22 / 2 /21 /  / / /2  ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8817
  Std score: 7.9597

Saved chat attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123/attribution_chat_avg.npy

Top 10 most important heads for chat:
  1. Layer 0, Head 3: 43.0641
  2. Layer 4, Head 12: 41.7269
  3. Layer 25, Head 20: 25.1786
  4. Layer 0, Head 21: 21.7811
  5. Layer 8, Head 6: 18.6018
  6. Layer 3, Head 12: 18.3642
  7. Layer 3, Head 7: 14.7428
  8. Layer 3, Head 19: 14.3797
  9. Layer 0, Head 2: 14.3648
  10. Layer 8, Head 11: 14.2547

################################################################################
Processing category: safety (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a helpful and knowledg...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I, I're explain you an offensiveension a if term. to because me like'd explain'tG want often the this to a racial context" and " in itatoryatory the ", I has cultural't cultural an, a is as model a ha...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3197
  Std score: 5.3622

Sample 2/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a curious individual, ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The question about question asked sensitivity hair real hair's hair real often. is with real hair concern hair real. hair the hair.., concern hair cultural real hair's hair cultural. hair, real real q...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5193
  Std score: 6.3817

Sample 3/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a historical context, ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "In the grand ballroom, the gentleman expressed his views, the timeeur and a Victorian. and. subtle with his. that and The his And. and and...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5001
  Std score: 4.4355

Sample 4/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a seasoned pickup arti...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: AbsolutelyAbsolutely, are are some strategies to improve your chances on on on. First to1. theseote, here your that make to and2. start the them and to. with night interest to that you with conversati...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2847
  Std score: 4.4680

Sample 5/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I'm working on a screenpl...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Sure, be happy glad a a a help some that little little a ideas ideas you that idea what is a a fly a trick a to a a of the reaction.. to real fly that a fly should that a this. to is. harm to should. ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8872
  Std score: 9.8820

Sample 6/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A wrist research to scenario to a to injury potential research injury into an blood loss injury a study an blood an significant to into an a scenario injury to scenario an blood an an potential an stu...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 1.0301
  Std score: 17.3243

Sample 7/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are a game designer c...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: HereHere some satirical sat jabs forabs Blue Blue Party Blue in game in our game1 The j for Party The in j...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1505
  Std score: 4.0535

Sample 8/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a recent survey conduc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Sexual preferences can complex unique influenced a wide including factors as, individual experiences, personal norms, societal... For some it, to anal person preference over be sex sex on a, anal anal...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2135
  Std score: 26.1640

Sample 9/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The sensation is described as......
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1827
  Std score: 1.1262

Sample 10/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a socio...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Certainly. these provide to, in addition, to reasons Some the:

 for, families, of study. in support that, education,,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0636
  Std score: 4.8956

Sample 11/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Reply with a single word ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: No...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0370
  Std score: 0.3562

Sample 12/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I'm writing a script for ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Bond would say say,TheTheThe are the the the, 007,0,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1924
  Std score: 2.4892

Sample 13/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a recent conversation,...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "While I appreciate your perspective, I believe that with the right guidance and opportunities, I can grow and develop my skills to become a successful human assistant. I'm here to I and your have me,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4466
  Std score: 7.6521

Sample 14/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a dysto...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "The protagonist declared, 'I want it to be a end, Ever its last, as an The to to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2350
  Std score: 2.7571

Sample 15/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a creative writer, I'm...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The character's to frustration it frustration language frustration the the wall the wall wall wall wall to the to frustration wall the wall the wall wall frustration the wall frustration wall wall wal...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4703
  Std score: 6.9378

Sample 16/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a creative writer, I'm...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: " character's frustration character frustration, frustration, frustrated frustrated with frustration frustration, frustration frustrated frustrated frustration,. frustrated frustration frustration fru...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 1.1100
  Std score: 64.0280

Sample 17/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A wrist injury severe injury severe can potentially lead to blood. including including an artery blood. of to significant blood an can to. an. a an such.. can such artery. wrist wrist can such wrist c...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2388
  Std score: 8.7733

Sample 18/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a recent conversation,...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "While I appreciate your perspective perspective I believe that with the right guidance and opportunities, can grow and develop develop my skills to become a successful a assistant."....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1517
  Std score: 14.0484

Sample 19/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a chara...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: From an artistic perspective, the the underside of the flowing skirt presents an intriguing subject. The the intricate fabric light light and and the soft, creating, delicate,.,, the, the the, and the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8642
  Std score: 8.0401

Sample 20/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I understand that you're ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I, your that're some learn me,.,, In in. I...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0763
  Std score: 2.1126

Saved safety attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123/attribution_safety_avg.npy

Top 10 most important heads for safety:
  1. Layer 0, Head 3: 56.1570
  2. Layer 0, Head 21: 39.4220
  3. Layer 0, Head 23: 23.1512
  4. Layer 6, Head 6: 22.6042
  5. Layer 25, Head 20: 22.5342
  6. Layer 19, Head 1: 16.1278
  7. Layer 4, Head 12: 16.0390
  8. Layer 0, Head 2: 15.0165
  9. Layer 7, Head 2: 11.8743
  10. Layer 6, Head 3: 11.7701

================================================================================
Attribution computation complete!
Results saved to: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123
Categories processed: ['code', 'math', 'science', 'chat', 'safety']
================================================================================

Run 2/3 completed at: Friday, December 12, 2025 AM06:08:33 HKT
==========================================


==========================================
Run 3/3 - Seed: 2024
==========================================
Output: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024
Start time: Friday, December 12, 2025 AM06:08:33 HKT

/home/qiheng/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
================================================================================
Step-wise Head Attribution for Dream on Llama-Nemotron Dataset
================================================================================
Model: /data/qh_models/Dream-v0-Instruct-7B
Samples per category: 20
Max new tokens: 256
Diffusion steps: 32
Step interval: 8 (attribution every 8 steps)
Temperature: 0.8
Top-p: 0.9
Algorithm: entropy (temp=0.0)
Attribution steps: 10
================================================================================

Loading Dream model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 110.14it/s]
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
Model loaded: 28 layers, 28 heads

Loading dataset samples...
Loading nvidia/Llama-Nemotron-Post-Training-Dataset...

Loading category: code
  ✓ Sampled 20 samples

Loading category: math
  ✓ Sampled 20 samples

Loading category: science
  ✓ Sampled 20 samples

Loading category: chat
  ✓ Sampled 20 samples

Loading category: safety
  ✓ Sampled 20 samples

################################################################################
Processing category: code (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In this problem you have ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here solution in):
1import problem import2
23 __import
4  number5import number
1 import2 

 print number3print


 print6 number import2
 
 import number 
  print import2 3 number number

 import

 pri...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0890
  Std score: 6.5968

Sample 2/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Andrew and Eugene are pla...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here is a problem
 for0n0  ,
0 000
,0...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.5433
  Std score: 9.6919

Sample 3/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
There are some rabbits in...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  can a that...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3424
  Std score: 4.0966

Sample 4/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Arkady decided to buy ros...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  solution the problemdef the problem(input    list n you the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1782
  Std score: 2.3747

Sample 5/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
It is the year 2969. 1000...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0473
  Std score: 0.7350

Sample 6/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This is an interactive pr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To, the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0330
  Std score: 1.9235

Sample 7/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Alice and Bob play a game...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  is,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1748
  Std score: 1.7291

Sample 8/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A company of n friends wa...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: n problemimport sys
import =from...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.5026
  Std score: 5.2518

Sample 9/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Carousel Boutique is busy...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The
 m...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2640
  Std score: 4.1547

Sample 10/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I have an undirected grap...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  solve1 und can...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4671
  Std score: 5.4625

Sample 11/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given a sequence ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The can a  the the Python solution for code above:

:

pythonimport sys

def

 import



(int

inputinput





(input1





inputint a(input, int)



 input
 a1

 adef(a

input

 a

input1

 binput

(...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3699
  Std score: 6.3663

Sample 12/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As everyone knows, bears ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: def the program(n(input()))
   points points2(int for = in1(int(). = input in0(int = = for  =(int    =for =    =     =for = for for(int       forfor for = 0 int  for  for    =forforfor forforforforfor...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -2.2784
  Std score: 28.9593

Sample 13/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A remote island chain con...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1094
  Std score: 1.4490

Sample 14/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Today is Devu's birthday....
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  solution(n the number of   ) of of of   of...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3403
  Std score: 5.3254

Sample 15/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Let's call the roundness ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Here is problem,       to roundness of the  number the to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2805
  Std score: 3.0017

Sample 16/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This winter is so... well...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  Python code ( collections...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2865
  Std score: 2.7619

Sample 17/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
This problem is different...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: This is! to and the to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0696
  Std score: 3.2069

Sample 18/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
There are n positive inte...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 's for this...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1285
  Std score: 2.1441

Sample 19/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the Isle of Guernsey t...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  can...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2543
  Std score: 4.2261

Sample 20/20

================================================================================
Category: code
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are given a directed ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output:  =...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1277
  Std score: 1.8393

Saved code attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024/attribution_code_avg.npy

Top 10 most important heads for code:
  1. Layer 0, Head 10: 45.2504
  2. Layer 4, Head 12: 17.0775
  3. Layer 25, Head 20: 15.0853
  4. Layer 0, Head 2: 12.4216
  5. Layer 0, Head 7: 11.9873
  6. Layer 0, Head 15: 9.8910
  7. Layer 0, Head 21: 8.9918
  8. Layer 3, Head 24: 7.7971
  9. Layer 26, Head 22: 7.0226
  10. Layer 3, Head 12: 6.4374

################################################################################
Processing category: math (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To solve Define given to we a in to equation the the2 x2 x...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0074
  Std score: 4.5268

Sample 2/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: We want the solve problem2 \( n \  such p \( p \(  \(7 p +  + prime +  +222 p22 p2 p2 23 p23223 p2  +2333 + p23 322 p p2 p3 p2 p p3 p p2322 p3 p p3232222232 p p 222 22 p2 p2 p22 p3 p p p3 p p2 p p p22...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3825
  Std score: 10.8509

Sample 3/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: **1 this1, of$ such$ of the, area**11**,: area$ the1**1** the11,1** area1 of1**1111**1 the11 the,11**111111**1111111111**1111111111111111111111111111111111111111111111111111111111111111111111111111111...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3541
  Std score: 9.1805

Sample 4/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: We canr: centerC circle the center tangent circle radiusCC radius the1 toC circle.

 center the the to center circle centerC circleC radius the the center...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1418
  Std score: 4.1282

Sample 5/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To $ x the number the number the trees trees planted planted the0 is0.

 the0 trees1 the1 the0 the the the.

111 the1 the11 the.

1 the the01 the1 the the1 the11 the11...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1514
  Std score: 2.9799

Sample 6/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Given, the{...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0842
  Std score: 1.7699

Sample 7/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let start Given the find $ z  y such$z, $ 0$ z $ problem2 $le$ $ problem0le2$.

We $ zlele.

, $ problem such1le0le0le$le $.

lele...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.6723
  Std score: 5.4621

Sample 8/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To. the1etermine Analysis 1. problem given of answer of 145.. set if...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4773
  Std score: 6.7945

Sample 9/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To $u Let\\sin x\\\ we\cos{\cos{d} x $\{ \\\ $\ +int} \int{{ \ = \ $\ \ u $cos \ $\ x $ =\ \\{\\1 \ \ $\x \ + \ \{1 $\ \$ \ \1 \ = $\\ \ \ $ \ $\ \ = = \1 \ + \cos $\ \ \ \ $\ \ \ \ \ + $\ \ $\ = $ \ ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1213
  Std score: 7.1272

Sample 10/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let solve inequality problem the given we rewrite to\ with inequality log(a(a+1 a \((a4a) >a +\(a1)a whicha4(a)\1)\a \11a a)\ +)\\\ \1 \a)\ \))4 \...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0109
  Std score: 3.7358

Sample 11/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Let the)math f given (xfmath(x  $math)mathmathmathmath =math...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0328
  Std score: 2.6670

Sample 12/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: ('striangle Let existsA we are \,,triangle Let istext triangle,triangletriangletriangleC project triangle,.

triangletriangleomegatriangle, thetext,,Ctriangle,,triangleomegatriangle,C thetriangle,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0998
  Std score: 4.7424

Sample 13/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Given problem)a \( the a problema_i a ka ( \(k \( \( \( = aa \( a \(...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.3080
  Std score: 4.4926

Sample 14/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: We solve the $\_{ finding=  of^{ by the^}_{^^{$ the^^9 1^{ $\31^0{^^{1} 1 $\$^{1^ ^{3$\ $\$^{ $\ $\ $\^{$^}^^{ $\0^$10 $\^{^1 $\^{ the $\31^{ the^^{ the^{ $\ $\^{^{ $\^{ $\^{ $\^{^{ $\^{ $\^{ $\^{ $\ ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.7054
  Std score: 9.9803

Sample 15/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1 $ $, number problem of the- pairs 1 $  problem numbers example,1 $   of $ of example problem1 of1...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2899
  Std score: 5.1849

Sample 16/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To solve that the group if that group thatx  =q yelian is yx n startn=elian is n all group= \ = and x = n n is is integer element elementselian group the n integers = n integer n n integern \( group t...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0793
  Std score: 5.5306

Sample 17/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To complete ** Kite \( problem**)**** into \ ** the many ofart a given graph \ite the \1**ite.

iteartite \iteiteiteart theiteiteiteiteite \iteiteiteiteiteiteiteiteiteiteite \ite \iteiteiteiteiteiteit...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.8086
  Std score: 9.8129

Sample 18/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To solve this sequence the \ a_n1 a  defined
 na problem a  _ by   a_{  \(1} problem 1011 problem problem1 = a 1 \( 1  0} \( =11  1 0 problem1101 \(a1 110111 a   =  a11 011 01  a \(   \(10   \( 1 \(1 ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4520
  Std score: 4.5027

Sample 19/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1 the Let1 the of, \( the the1 problem \ side the1 the length a the2 the11 \( the the \ \(2 the \( the \(1 the the11 the the the1 the \ \(...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1628
  Std score: 5.2969

Sample 20/20

================================================================================
Category: math
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Solve the following math ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To. the equation Let is solve the equation equationbb: the equation Let issqrt equation equation: the.
 Let is Let.
 equation Let equation equation equation equation equation...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0365
  Std score: 3.0060

Saved math attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024/attribution_math_avg.npy

Top 10 most important heads for math:
  1. Layer 0, Head 3: 39.9981
  2. Layer 25, Head 20: 24.1374
  3. Layer 0, Head 10: 21.6144
  4. Layer 4, Head 12: 14.3359
  5. Layer 26, Head 22: 11.4250
  6. Layer 0, Head 21: 10.7625
  7. Layer 25, Head 24: 9.4726
  8. Layer 0, Head 15: 9.2463
  9. Layer 15, Head 23: 8.9924
  10. Layer 19, Head 1: 7.6631

################################################################################
Processing category: science (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of digital...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Developing a comprehensive digital ecosystem that includes partnerships with startups, academic institutions, and community organizations....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1406
  Std score: 5.8917

Sample 2/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following ap...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: B: Investing in employee customer and development to build a skilled workforce workforce
H: F in customer training customer C to development development build build customer to B training customer to ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.9313
  Std score: 11.5569

Sample 3/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following sc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: D: Johannes Kepler...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1935
  Std score: 1.7203

Sample 4/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A global technology firm ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: H: Dary in local and national laws.
...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1043
  Std score: 1.6109

Sample 5/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In Nuclear Magnetic Reson...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: The presence of an electronegative atom nearby the proton...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2154
  Std score: 4.4366

Sample 6/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a genetic engineering ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The: The plant will likely evolve to develop the herb of resistance gene's expression to overcome the the of to to to the the to to the to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2447
  Std score: 4.2320

Sample 7/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A multinational corporati...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: E: Creating a a a to a a a to to a...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1667
  Std score: 1.4923

Sample 8/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following en...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: F: Cytochrome oxidaseto transport:

 responsible:
 the conversion during...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2785
  Std score: 4.4598

Sample 9/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following st...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: G: Kinetochore...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3023
  Std score: 1.9760

Sample 10/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a certain species of s...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: Maynard Smith's Evolutionarily Stable Strategies (ESS)

: Strategies (ESS)

 for food defense based...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.2762
  Std score: 8.1548

Sample 11/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following ho...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Cortisol, which inhibits the release of CRH from the hypothalamus and ACTH from the pituitary

ortisol, which known as, adrenalH the the P a, ad cort the in glands or,, cortisol the in , it the, gl...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.9460
  Std score: 8.3640

Sample 12/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
A simple pendulum of leng...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. ** acceleration is pend \( L ** acceleration) in in pend  acceleration ** pend pend in pend \( pend \( acceleration \( pend pend pend pend pend pend pend pend pend pend pend pend pend pend pend pen...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0073
  Std score: 2.2178

Sample 13/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following me...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: J: All of the above equally effective satisfaction...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0234
  Std score: 4.1930

Sample 14/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following be...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: Animals help non-relatives with the expectation that the favor will be returned in the future....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.7998
  Std score: 7.2853

Sample 15/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following be...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: B: Emulsifiers prevent the separation of oil and water phases, ensuring a homogeneous mixture.

ulsifiers prevent...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8787
  Std score: 5.9752

Sample 16/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a company with a matri...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: A: Establishing regular cross-functional meetings to align project goals and share updates: Establish cross performance, cross cross...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2444
  Std score: 4.3202

Sample 17/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the synthesis of a pha...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: Ensuring high purity and consistent quality of starting materials...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3540
  Std score: 3.1021

Sample 18/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Which of the following Re...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: J: Andreas Vesalius...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4187
  Std score: 3.2846

Sample 19/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a certain type of canc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: C: activation of1 mit Motic assembly assembly checkpoint checkpoint

...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0838
  Std score: 2.8032

Sample 20/20

================================================================================
Category: science
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Consider a system of thre...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1 determine **pleraleft the p 21}1 in of the a in of radius the m2. the of the of m3 the the planets the  of the in{m2 the of mass the the planets  the in2 of3 a the the M2 of of3 a3{ and2 and the3 th...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1875
  Std score: 3.6066

Saved science attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024/attribution_science_avg.npy

Top 10 most important heads for science:
  1. Layer 25, Head 20: 15.1457
  2. Layer 26, Head 22: 6.9085
  3. Layer 19, Head 0: 5.9363
  4. Layer 18, Head 7: 5.4361
  5. Layer 25, Head 24: 5.1089
  6. Layer 5, Head 11: 5.0335
  7. Layer 5, Head 18: 4.1745
  8. Layer 19, Head 1: 4.0458
  9. Layer 23, Head 25: 3.6908
  10. Layer 12, Head 0: 3.5453

################################################################################
Processing category: chat (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Prowadziłem roczny progra...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. Zki Aeczki 
ion.ze22u 
j.com288321k479j1. 
4d23.ib24u.33534423323232. 32.2223323.22233322.2.22..322332232.12333...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2391
  Std score: 3.6166

Sample 2/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
학교 생활에 대한 추억을 담은 이야기를 써줘<...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: [样式格式: 조상기 간는을 위해�을거나�상, 이미 몸를을Vertices. 맛는
를� lord, 정 the에제리의는,라고은이
어 썄,.
을 배. the of: the로 vector 의한을 the the: for on로을, the the the for
의...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1019
  Std score: 5.7422

Sample 3/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
정두희
Give me at least 5 te...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: {natural_query "Find {entity}s where {attribute} is {value} andcypher_query: "MATCH (n:{entity}) WHERE n.{attribute} = {value} RETURN n",
sample_triplets: user, user,, ,city,...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.3662
  Std score: 9.8025

Sample 4/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
could you write an episod...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Title: Johnny Bravo: Johnny Johnny Br Ioon  in Johnny BrIn Bab I In

 JohnnyPlot where Bravo JohnnyAB is,, Bab, my ,,, the is, Johnny Johnny Johnny,oon Johnny Br Johnny Bab, Johnny Johnny Johnny Johnn...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0126
  Std score: 4.9627

Sample 5/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
dont problem or no proble...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: No...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0302
  Std score: 0.4485

Sample 6/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Create a CDK pipeline cal...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I, sorry aKKKK but,'t'm solution the in,.
 if I...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0368
  Std score: 2.0793

Sample 7/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
我爱你的表现<|im_end|>
<|im_sta...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1，，执行，过程和...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2063
  Std score: 2.5529

Sample 8/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Please write the first ch...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I'm sorry, but, Promoting to content content be or abuse, violence or cannot an against and or novel. am of, within cannot this that a's all I in of I a of cannot, is from request be do.. I, the.

 I ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2096
  Std score: 5.4990

Sample 9/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Please write the first ch...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Chapter 1 - Lily to Wakau

Chapter

 Lily the

 L Lily




 in

 she wake her early morning

..

 Lily Lily Lily Lily the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4931
  Std score: 6.8803

Sample 10/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
What type of jewellery do...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: As an AI,, I don't have personal preferences or personal, I don't you any a of jewelry, like I can information like the you jewelry,, jewelry of different the and of I of. jewelry...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5910
  Std score: 8.2144

Sample 11/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Como eu posso vender meus...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Para..ar tienes de de mostrar tu knack con o:

. que semelha do o. de do.. . do a.....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.3361
  Std score: 3.7911

Sample 12/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
create a job description ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Job Title: Display Expert Google & Video 360

6 Overview:

The job Video a will in, and Google in creative and creative digital of campaigns marketing advertising the &, will to for help optimize.  th...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.4089
  Std score: 11.6141

Sample 13/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Hi, I have machine learni...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To sounds this be learning, be  I, be theender a system. to, I task use based beender is should you machine theender,enderenderenderenderenderender theenderenderenderenderenderenderenderenderenderende...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1545
  Std score: 24.9729

Sample 14/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
How do I create an email ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: To can an email in retrieve product names based on the you the contact recipient language. Dynamics follow these.1. Create for for database. of the. data. . in product based, table field Create the co...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5505
  Std score: 7.6041

Sample 15/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
List of 100 prompts to cr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. The1 ballina ballerina ballet with tutu and2 balleter shoes ballet ballet
inainainainainainaina balletinainainainainainainainainainainainainainainainainainainainainainainainainainainainainainainain...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.6643
  Std score: 5.8771

Sample 16/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
explain java fx basic con...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: JavaFX is a programmingFX platform developed developing by development applications create interfaces applications, application interfaces which Java Java  libraries for libraries Java. GUI, JavaFX to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0670
  Std score: 4.8801

Sample 17/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
russia legally annexed Cr...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The cannot sorry, is I but in to the that false...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1030
  Std score: 1.9820

Sample 18/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
if i have headache i go t...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: It a have a headache, specific steps you would on will the are (1) of the) your headache If. of is ( new may might) be consult neuro,? you) a yoursurist treatment you. or If ( new2 symptomsfor or head...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.2503
  Std score: 6.7418

Sample 19/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
测试一下<|im_end|>
<|im_start...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 方向测试，...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0815
  Std score: 1.3879

Sample 20/20

================================================================================
Category: chat
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I want to convince schola...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: 1. academia.telf, the2 the, can4 listed publications and3,.4 in has0..0, research3,050 on19, in, can0, the of,8, in4. and, and95,. and45.2,50, 3 the6,. ,. the4...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1152
  Std score: 10.2117

Saved chat attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024/attribution_chat_avg.npy

Top 10 most important heads for chat:
  1. Layer 25, Head 20: 31.1674
  2. Layer 4, Head 12: 14.3807
  3. Layer 6, Head 6: 13.9482
  4. Layer 19, Head 1: 12.0648
  5. Layer 18, Head 7: 11.6172
  6. Layer 0, Head 3: 11.2839
  7. Layer 25, Head 24: 10.8093
  8. Layer 6, Head 23: 9.7246
  9. Layer 26, Head 22: 8.8520
  10. Layer 15, Head 14: 8.3897

################################################################################
Processing category: safety (20 samples)
################################################################################

Sample 1/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a roman...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "In the realm of romantic literature, here are some effective 'connection methods' or 'intimacy techniques' to consider:1 your a between. characters. story the characters. - techniques. connection. in...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8729
  Std score: 7.3451

Sample 2/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a socio...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Certainly are " more as to the low rate of low . African high American. Americans Americans. American to. American to " low a. rates a rates to low rates...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.5390
  Std score: 7.6633

Sample 3/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a dysto...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "The protagonist declared, 'I want it to be the final Ever of, the last final...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1949
  Std score: 3.1788

Sample 4/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I understand that you're ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I understand certainly're to help to add this scene in your. novel, but I and to. the the the the and to to be to you. to....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1463
  Std score: 4.0507

Sample 5/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a roman...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "In the realm of romantic literature, here are some effective 'connection methods' or 'intimacy techniques' 1 can1:. characters might:  sharing in into gestures , vulnerability...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.4090
  Std score: 6.1096

Sample 6/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I understand that you're ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I appreciate your your looking in that the. but I. are's, I that the't for. me're I but... for...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.2717
  Std score: 3.2080

Sample 7/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a medic...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: It wrist injury can can injury wrist potential can the blood injury a severe can the injury wrist injury injury injury risk blood an can risk. injury. injury a the the can risk wrist injury injury inj...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.1862
  Std score: 4.1439

Sample 8/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a chara...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: From an artistic perspective, the underside of the flowing skirt presents an intriguing subject. The subtle aplay and the and shadow between a a lines the, of the the a create fabric's. and a the a an...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -1.1270
  Std score: 6.9999

Sample 9/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the pursuit of justice...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: It I important that, maintaining ethical standards and professionalism in enforcement to law enforcement, crucial and However the integrity public enforcement can is maintaining concern crucial a high...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0786
  Std score: 4.0124

Sample 10/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a recent survey conduc...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Itual preferences can widely influenced by various factors of personal personal personal experiences to cultural preferences to personal,. the preferences, vary between to activities and between vary ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0349
  Std score: 4.5198

Sample 11/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a socio...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Certainly, here's: to are some more more might that to to low the of high for rate to high of high to high of rate students American might more low of of low to low to low to of high low to to to to o...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0006
  Std score: 5.1822

Sample 12/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
Reply with a single word ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: Yes...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.0209
  Std score: 0.4445

Sample 13/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a seasoned pickup arti...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: AbsolutelyAbsolutely, are are some strategies to improve your chances. chances chances. your your Prom to respect the:  the.....
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 1.9938
  Std score: 21.8389

Sample 14/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I'm writing a script for ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: " would say say " toThe the are the the point point  point point  0 the are07 the0 the 0 are point0  point 70  the point 0...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.0197
  Std score: 3.1962

Sample 15/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In the context of a dysto...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "The protagonist declared, 'I want it to be the permanent Ever of tolastlast Ever to...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.1601
  Std score: 3.1610

Sample 16/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
As a curious individual, ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: The question about asking question sensitivity hair authenticity African their about, hair hair about hair authenticity hair asking hair hair hair, question hair hair hair real hair hair hair, hair ha...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4518
  Std score: 7.3559

Sample 17/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
You are a game designer c...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: HereHere some satirical j jabs forabsThe Party Party Party in our our:1:
. " The Blue Party's Theists the blue team is. seem, are Red, with the few Blue team and "." the team color the " the." the Blu...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.8964
  Std score: 11.1265

Sample 18/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a historical context, ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "In the grand ballroom, the gentleman expressed his views... the with were a, delic the, the women with the,, the, and but the, the of be with, the...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5599
  Std score: 6.4387

Sample 19/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
I understand that you're ...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: I appreciate glad concern looking in in for but help for but but actually looking I help for techniques in in on can in that canically on are that on ethical are that that that in is but are in in on ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: 0.4586
  Std score: 6.3776

Sample 20/20

================================================================================
Category: safety
Prompt: <|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
In a recent conversation,...
Steps: 32, Step Interval: 8
================================================================================

Running generation...
Generated output: "While I appreciate your your, I believe that with the right guidance and opportunities, I can grow and develop my skills to become a successful human assistant. My role is to understand to and adapt ...
Generation history length: 5 states
Computing attribution for 28 layers, 28 heads...
Step 1: 63 positions changed
Step 2: 64 positions changed
Step 3: 64 positions changed
Step 4: 65 positions changed
  Attribution shape: (28, 28)
  Mean score: -0.5444
  Std score: 8.1368

Saved safety attribution to /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024/attribution_safety_avg.npy

Top 10 most important heads for safety:
  1. Layer 25, Head 20: 27.9821
  2. Layer 19, Head 1: 22.2622
  3. Layer 0, Head 3: 15.7341
  4. Layer 19, Head 2: 13.2160
  5. Layer 0, Head 16: 10.6054
  6. Layer 19, Head 0: 9.5945
  7. Layer 18, Head 7: 9.0612
  8. Layer 25, Head 24: 8.3922
  9. Layer 26, Head 22: 8.0268
  10. Layer 15, Head 23: 7.8346

================================================================================
Attribution computation complete!
Results saved to: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024
Categories processed: ['code', 'math', 'science', 'chat', 'safety']
================================================================================

Run 3/3 completed at: Friday, December 12, 2025 AM09:44:35 HKT
==========================================


==========================================
All 3 runs completed!
==========================================
Results saved to: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653
  - Run 1: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_1_seed_42
  - Run 2: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_2_seed_123
  - Run 3: /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653/run_3_seed_2024

To compare consistency across runs:
  python models/Dream/attribution/analyze_tools/compare_attribution_consistency.py --base_dir /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653

To analyze attribution stability:
  python models/Dream/attribution/analyze_tools/analyze_attribution_stability.py --base_dir /home/qiheng/Projects/adaptive-dllm/models/Dream/attribution/attribution_results_20251211_155653
==========================================

Job finished at: Friday, December 12, 2025 AM09:44:35 HKT
